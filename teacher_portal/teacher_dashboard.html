<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Teacher Home</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.5/index.global.min.css" />
  <link rel="stylesheet" href="teacher_home.css" />
  <style>
    body {
      background: #edeaff;
      font-family: 'Inter', sans-serif;
    }
    .sidebar-gradient {
      background: linear-gradient(180deg, #a78bfa 0%, #7c3aed 100%);
    }
    .sidebar-icon {
      background: rgba(255,255,255,0.11);
      border-radius: 16px;
      padding: 12px;
      box-shadow: 0 2px 8px 0 rgba(124,58,237,0.09);
    }
    .sidebar-active, .sidebar-menu:hover {
      background: linear-gradient(90deg, #7c3aed 70%, #a78bfa 100%);
      color: #fff;
      font-weight: bold;
    }
    .sidebar-menu {
      transition: background 0.2s, padding-left 0.3s;
      cursor: pointer;
      padding-left: 1.25rem;
    }
    .sidebar-menu .icon {
      margin-right: 1rem;
    }
    .sidebar-menu svg {
      display: inline-block;
      vertical-align: middle;
    }
    .sidebar {
      min-width: 230px;
      max-width: 260px;
      border-radius: 32px;
      box-shadow: 6px 0 32px 0 rgba(124,58,237,0.10);
      margin: 24px;
    }
    .sidebar-avatar {
      border: 5px solid #f1eaff;
      box-shadow: 0 2px 12px 0 rgba(124,58,237,0.10);
    }
    .sidebar-logout {
      color: #a78bfa;
      background: #edeaff;
      font-weight: bold;
      border-radius: 18px;
      transition: background 0.2s, color 0.2s;
    }
    .sidebar-logout:hover {
      background: #f87171;
      color: #fff;
    }
    @media (max-width: 900px) {
      .sidebar {
        margin: 0;
        border-radius: 0 32px 32px 0;
      }
    }
    /* Blinking for "..." */
    .animate-blink {
      animation: blink 1.2s steps(1, end) infinite;
    }
    @keyframes blink {
      0%,100% { opacity: 1; }
      50% { opacity: 0; }
    }
  </style>
</head>
<body class="flex min-h-screen">

  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar sidebar-gradient text-white flex flex-col justify-between py-7 px-4 relative">
    <div>
      <div class="flex flex-col items-center mb-8 mt-3">
        <div class="w-20 h-20 rounded-2xl bg-white/30 flex items-center justify-center mb-3 sidebar-avatar">
          <img src="/teacher_portal/teacher_portal/imag/logo.png" alt="Avatar" class="w-18 h-18 rounded-2xl object-cover" />
        </div>
        <h2 class="text-lg font-bold tracking-wide text-white text-center mb-1"> EASTERN PANGASINAN CHRISTIAN LEARNING CENTER, INC.</h2>
      </div>
      <nav>
        <ul class="space-y-1 mt-6">
          <li class="sidebar-menu flex items-center py-3 px-3 rounded-2xl sidebar-active" id="home-tab">
            <span class="icon mr-3"><svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M3 9.5L12 3L21 9.5V20C21 20.55 20.55 21 20 21H4C3.45 21 3 20.55 3 20V9.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M9 21V12H15V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg></span> Home
          </li>
          <li class="sidebar-menu flex items-center py-3 px-3 rounded-2xl" id="class-tab">
            <span class="icon mr-3"><svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="7" width="18" height="13" rx="2" stroke="currentColor" stroke-width="2"/>
              <path d="M16 3H8V7H16V3Z" stroke="currentColor" stroke-width="2"/>
            </svg></span> Class
          </li>
          <li class="sidebar-menu flex items-center py-3 px-3 rounded-2xl" id="class-record-tab">
            <span class="icon mr-3"><svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
              <path d="M7 3V7" stroke="currentColor" stroke-width="2"/>
              <path d="M17 3V7" stroke="currentColor" stroke-width="2"/>
            </svg></span> Class Record
          </li>
          <li class="sidebar-menu flex items-center py-3 px-3 rounded-2xl" id="announcement-tab">
            <span class="icon mr-3"><svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M12 19C15.3137 19 18 16.3137 18 13C18 9.68629 15.3137 7 12 7C8.68629 7 6 9.68629 6 13C6 16.3137 8.68629 19 12 19Z" stroke="currentColor" stroke-width="2"/>
              <path d="M12 3V7" stroke="currentColor" stroke-width="2"/>
            </svg></span> Announcement
          </li>
        </ul>
      </nav>
    </div>
    <div class="mb-2">
      <button id="logout-btn" class="sidebar-logout w-full py-2">Log out</button>
    </div>
  </aside>

  <!-- Main Content Area -->
  <main id="main-content" class="flex-1 flex flex-col items-center justify-center p-8">
    <!-- HOME DASHBOARD (shown by default) -->
    <div id="home-dashboard" class="w-full">
      <nav class="flex items-center bg-violet-100/90 px-8 py-4 border-b-4 border-violet-400 shadow rounded-2xl mb-7 w-full max-w-4xl mx-auto">
        <span class="text-3xl font-bold text-violet-800 tracking-wider select-none">HOME</span>
      </nav>
      <section class="bg-white/90 border-4 border-violet-300 rounded-3xl w-full max-w-2xl mb-10 p-8 flex flex-col items-center shadow-xl">
        <h1 class="text-4xl font-extrabold text-violet-700 mb-2 tracking-tight">Welcome</h1>
        <p class="text-2xl text-violet-600 font-semibold tracking-wide">
          Great Morning, <span id="teacher-name" class="font-extrabold">Jed</span>
          <span class="animate-blink">...</span>
        </p>
      </section>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-10 w-full max-w-4xl mx-auto">
        <!-- Announcement Box -->
        <section id="announcement-box" class="border-4 border-violet-300 bg-white/90 rounded-2xl p-6 min-h-[230px] flex flex-col shadow-lg">
          <div class="text-xl font-bold text-violet-700 mb-3">Announcement</div>
          <div id="announcement-content" class="flex-1 flex flex-col justify-center"></div>
        </section>
        <!-- Calendar + Badge Column -->
        <div class="flex flex-col gap-8">
          <!-- Calendar Box -->
          <section class="border-4 border-violet-300 bg-white/90 rounded-2xl p-6 mb-3 shadow-lg">
            <div class="text-xl font-bold text-violet-700 mb-2 border-b border-violet-200 pb-1 text-center uppercase">Calendar</div>
            <div id="calendar" class="w-full"></div>
          </section>
          <!-- Badge Box -->
          <section class="border-4 border-violet-300 bg-white/90 rounded-2xl p-6 flex flex-col items-center shadow-lg">
            <div class="text-xl font-bold text-violet-700 mb-2 border-b border-violet-200 pb-1 text-center uppercase w-full">Badge</div>
            <div id="badge-stars" class="flex items-center gap-4 pt-2 w-full justify-center"></div>
          </section>
        </div>
      </div>
    </div>
  </main>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.5/index.global.min.js"></script>
  <script>
    // Sidebar navigation (with highlighting)
    function setActiveSidebar(tabId) {
      document.querySelectorAll('.sidebar-menu').forEach(el => el.classList.remove('sidebar-active'));
      document.getElementById(tabId).classList.add('sidebar-active');
    }
    // Sidebar navigation redirects
    document.getElementById('home-tab').onclick = function() {
      setActiveSidebar('home-tab');
      window.location.href = "teacher_home.html";
    };
    document.getElementById('class-tab').onclick = function() {
      setActiveSidebar('class-tab');
      window.location.href = "teacher_class.html";
    };
    document.getElementById('class-record-tab').onclick = function() {
      setActiveSidebar('class-record-tab');
      window.location.href = "teacher_classrecord.html";
    };
    document.getElementById('announcement-tab').onclick = function() {
      setActiveSidebar('announcement-tab');
      window.location.href = "teacher_announcement.html";
    };

    // Logout
    document.getElementById('logout-btn').onclick = function () {
      alert('You have been logged out.');
      window.location.reload();
    };

    // Set teacher name
    document.getElementById('teacher-name').textContent = 'Jed';

    // Announcement logic
    function getAnnouncements() {
      try {
        return JSON.parse(localStorage.getItem("announcements") || "[]");
      } catch (e) {
        return [];
      }
    }
    function renderLatestAnnouncement() {
      const container = document.getElementById('announcement-content');
      const announcements = getAnnouncements();
      container.innerHTML = '';
      if (!announcements.length) {
        container.innerHTML = '<div class="text-gray-400 italic">No announcement</div>';
        return;
      }
      const a = announcements[0];
      if (a.title) {
        const t = document.createElement('div');
        t.className = "font-bold text-lg mb-1";
        t.textContent = a.title;
        container.appendChild(t);
      }
      if (a.grade) {
        const c = document.createElement('div');
        c.className = "italic text-violet-700 text-sm mb-2";
        c.textContent = `For: ${a.grade}`;
        container.appendChild(c);
      }
      if (a.message && a.message.trim()) {
        const p = document.createElement('p');
        p.className = "mb-2";
        p.innerHTML = a.message.replace(/\n/g, '<br>');
        container.appendChild(p);
      }
      if (a.images && a.images.length) {
        const mediaDiv = document.createElement('div');
        mediaDiv.className = "flex flex-wrap gap-2 mb-2";
        a.images.forEach(m => {
          if (m.type && m.type.startsWith("image/")) {
            const img = document.createElement('img');
            img.src = m.dataUrl;
            img.alt = "announcement image";
            img.className = "max-h-32 max-w-xs rounded shadow";
            mediaDiv.appendChild(img);
          }
        });
        container.appendChild(mediaDiv);
      }
      const time = document.createElement('div');
      time.className = "text-xs text-gray-400 mt-2";
      time.textContent = a.time ? new Date(a.time).toLocaleString() : '';
      container.appendChild(time);
    }

    // On load
    document.addEventListener('DOMContentLoaded', function() {
      renderLatestAnnouncement();

      // Initialize calendar
      if (document.getElementById('calendar')) {
        document.getElementById('calendar').innerHTML = '';
        const calendarEl = document.getElementById('calendar');
        const calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: 'dayGridMonth',
          height: 240,
        });
        calendar.render();
      }

      // Badge stars
      const badgeDiv = document.getElementById("badge-stars");
      if (badgeDiv) {
        badgeDiv.innerHTML = '';
        for (let i = 0; i < 5; i++) {
          let star = document.createElementNS("http://www.w3.org/2000/svg", "svg");
          star.setAttribute("viewBox", "0 0 50 50");
          star.setAttribute("width", "34");
          star.setAttribute("height", "34");
          star.innerHTML = `
            <polygon points="25,5 31,19 46,19 34,29 39,44 25,35 11,44 16,29 4,19 19,19"
              fill="#fff" stroke="#7c3aed" stroke-width="4"/>
            <polygon points="25,10 30,20 41,20 33,27 36,38 25,32 14,38 17,27 9,20 20,20"
              fill="#a78bfa" stroke="#7c3aed" stroke-width="2"/>
          `;
          badgeDiv.appendChild(star);
        }
      }
    });
    window.addEventListener('storage', function(e) {
      if (e.key === "announcements") {
        renderLatestAnnouncement();
      }
    });
  </script>
</body>
</html>